<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> [paper-review] Motion Planning Networks | Joel Lee </title> <meta name="author" content="Joel Lee"> <meta name="description" content="paper review about MPNet"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://joonhyung-lee.github.io//blog/2023/mpnet/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?bf50d6d9dd867d3e0f3b0add94449649"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> Joel Lee </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">miscellaneous </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/repositories/">repositories</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/teaching/">teaching</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/gallery/">gallery</a> </div> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">[paper-review] Motion Planning Networks</h1> <p class="post-meta"> November 26, 2023 </p> <p class="post-tags"> <a href="/blog/2023"> <i class="fa-solid fa-calendar fa-sm"></i> 2023 </a>   ·   <a href="/blog/tag/motion-planning"> <i class="fa-solid fa-hashtag fa-sm"></i> Motion Planning</a>   <a href="/blog/tag/auto-encoder"> <i class="fa-solid fa-hashtag fa-sm"></i> Auto Encoder</a>   <a href="/blog/tag/icra"> <i class="fa-solid fa-hashtag fa-sm"></i> ICRA</a>   <a href="/blog/tag/2019"> <i class="fa-solid fa-hashtag fa-sm"></i> 2019</a>     ·   <a href="/blog/category/paper-review"> <i class="fa-solid fa-tag fa-sm"></i> paper-review</a>   <a href="/blog/category/paper-review-robotics"> <i class="fa-solid fa-tag fa-sm"></i> paper-review/robotics</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <blockquote> <p>ICRA 2019. [<a href="https://arxiv.org/pdf/1806.05767.pdf" rel="external nofollow noopener" target="_blank">Paper</a>] [<a href="https://github.com/ahq1993/MPNet/tree/master" rel="external nofollow noopener" target="_blank">Github</a>]</p> <p>Ahmed H. Qureshi, Anthony Simeonov, Mayur J. Bency and Michael C. Yip <sup>1</sup> University of California San Diego, La Jolla, CA 92093 USA<sup>1</sup></p> <p>Feb. 24</p> </blockquote> <div align="center"> <img src="/assets/img/mpnet/mpnet-overview.png" width="75%"> <p>Fig. 1: Introduction figure about MPNet paper.</p> </div> <h3 id="한-문장-요약">한 문장 요약</h3> <p>Learnable한 Collision-free Motion Planning Network를 제시한다.</p> <h3 id="contribution">Contribution</h3> <div align="center"> <img src="/assets/img/mpnet/mpnet-architecture.png" width="100%"> <p>Fig. 2: Overall architecture about MPNet.</p> </div> <ul> <li>Offline: 1) Encoder Netowork, 2) Planning Network</li> <li>Online: Neural Planner</li> </ul> <h3 id="terminology">Terminology:</h3> <ul> <li>\(Q\): ordered list of length \(N \in \mathbb{N}\)</li> <li>\(\{q_{i}=Q(i)\}_{i\in N}\): mapping from \(i\in \mathbb{N}\) to the \(i\)-th element of \(Q\).</li> <li>\(X \subset \mathbb{R}^{d}\): state space, where \(d\in \mathbb{N}\) is the dimensionality of the state space. <ul> <li>\(d_{w}\in \mathbb{N}\): workspace dimensionality</li> </ul> </li> <li>\(X_{\text{obs}} \subset X\): obstacle state space</li> <li>\(X_{\text{free}} \subset X\textbackslash X_{\text{obs}}\): obstacle state space <ul> <li>Initial state \(x_{\text{init}} \in X_{\text{free}}\), goal region be \(X_{\text{goal}} \subset X_{\text{free}}\)</li> </ul> </li> </ul> <p>목적은 solution path \(\tau\)가 entirely obstacle-free space \(X_{\text{free}}\)에 존재하도록 하는 것이다.</p> <h3 id="methodology">Methodology:</h3> <p>(A) offline training of the neural models, and (B) online path generation; 2개의 모듈로 구성되어 있다.</p> <div align="center"> <img src="/assets/img/mpnet/mpnet-alg-enc.png" width="75%"> <p>Fig. 3: Algorithm about MPNet (Offline).</p> </div> <ol> <li>Offline Training <ul> <li>Obstacle point cloud(=scene)을 latent space에 embedding 시키고 (Encoder Network), obstacle encoding \(Z\)로부터 Planning Network로 \(\hat{x}_{t+1}\)을 추정한다.</li> <li> <strong>Enet: Encoder Network</strong> <ul> <li>Contractive Autoencoder를 사용했다. <ul> <li>obstacle pointcloud \(X_{\text{obs}}\)를 \(Z\in \mathbb{R}^m\)에 embedding 시킴.</li> </ul> </li> </ul> </li> </ul> </li> </ol> \[\begin{equation} L_{\text{AE}}(\theta^{e},\theta^{d})=\frac{1}{N_{\text{obs}}} \sum_{x\in D_{\text{obs}}} || x-\hat{x} ||^2 + \lambda \sum_{ij} (\theta^{e}_{ij})^{2} \end{equation}\] <ul> <li>\(\theta^{e}\): parameters of encoder</li> <li> <p>\(\theta^{d}\): parameters of decoder</p> </li> <li> <strong>Pnet: Planning Network</strong> <ul> <li> \[\hat{x}_{t+1}=\text{Pnet}((x_{t},x_{T},\mathbf{Z});\mathbf{\theta})\] </li> <li>Expert data로 학습을 진행함. (MSE Loss)</li> </ul> </li> </ul> \[\begin{equation} L_{\text{Pnet}}(\theta)=\frac{1}{N_{p}} \sum_{j}^{\hat{N}}\sum_{i=0}^{T-1} || \hat{x}_{j,i+1}-x_{j,i+1} ||^2 \end{equation}\] <div align="center"> <img src="/assets/img/mpnet/mpnet-alg-plan.png" width="75%"> <p>Fig. 4: Algorithm about MPNet (Neural Planner).</p> </div> <div align="center"> <img src="/assets/img/mpnet/mpnet-alg-replan.png" width="75%"> <p>Fig. 5: Algorithm about MPNet (Replanning).</p> </div> <ol> <li>Online Path Planning <ul> <li>Offline에서 학습한 모델을 기반으로 (collision-free) motion planning을 수행하기 위해 Bidirectional path generation heuristic을 제시함. <ul> <li>Pnet: stochaticity를 추가하기 위해 일정 확률로 dropout 을 수행함. (\(p: [0.1]\in \mathbb{R}\))</li> <li>Lazy States Contraction (LSC): connect_tree 함수와 동일함.</li> <li>Steering: 일반적인 planner의 steer 함수와 동일함.</li> <li>isFeasible: 일반적인 planner의 feasibility 함수와 동일함.</li> <li>Neural Planner: 저자가 말하는 Bidirectional path generation. <ul> <li>\(\tau^{a}, \tau^{b}\): 각각 init state로부터 시작하는 path, goal state로부터 시작하는 path를 의미함.</li> <li>우선 \(\tau^{a}\)부터 범위를 확장해가며, planning을 수행함. 여기서 not connectable 한다면 \(\tau^{b}\)부터 범위를 확장해감: <strong>swap function</strong> </li> </ul> </li> </ul> </li> </ul> </li> </ol> <h3 id="implementation--experiments">Implementation &amp; Experiments</h3> <ul> <li>110개의 서로 다른 workspace: simple 2D, rigid-body, complex 2D/3D <ul> <li>100개의 workspace, 각 4000개의 trajectory로 학습을 수행함. 여기서 사용된 trajectory는 RRT\(^*\)로부터 취득함.</li> </ul> </li> <li>Enet: three linerar layers and an output layer, Parametric ReLU를 사용함.</li> <li> <p>Pnet: 9-layers and 12-layers DNN, PReLU를 사용함. 모든 은닉층에 dropout도 포함되어 있음.</p> </li> <li>Baeslines: MPNet+Neural-Replanning / MPNet+Hybrid-Replanning / Informed-RRT\(^*\) / BIT\(^*\)</li> <li>Evaluation metric: Time [s] / Accuracy [%]</li> </ul> <div align="center"> <img src="/assets/img/mpnet/mpnet-results.png" width="100%"> <p>Fig. 6: Results about MPNet.</p> </div> <h3 id="conclusion">Conclusion:</h3> <p>MPNet은 (1) obstacle geometry에 관계없이 motion planning을 잘 하며, (2) exec. time이 평균적으로 1초 이내에 수행되었으며, (3) unseen obstacle location에서도 잘 동작했으며, (4) completeness를 보장한다.</p> <h3 id="thoughts">Thoughts:</h3> <ul> <li>Encoder에 Scene pointcloud가 들어가며, <strong>Contractive Autoencoder</strong>로 obstacle에 대해 embedding 시킨다는 점에서 제가 진행하고자 하는 연구와 유사한 점을 느꼈습니다. <ul> <li>다만 단순한 Linear layer(PReLU) 만으로 pointcloud 데이터를 학습했다는 것이 신기합니다. 해당 시기에 PointNet/FoldingNet/DGCNN 등 pointcloud based architecture가 여러 있었는데도 불구하고 이렇게 수행했다는 것이 신기합니다. 제가 알기로는 rigid motion에 대해 invariant 해야할텐데, 이를 단순 linear layer 만으로 어떻게 잘 학습했는지가 궁금합니다.</li> </ul> </li> <li>앞서 학습된 Autoencoder를 사용해, expert trajectory로 planner를 학습합니다. <ul> <li>알고리즘상으로는 RRT-Star와 큰 차이는 없으며, Bidirectional하게 수행된다는 것이 차이점이라고 생각됩니다.</li> </ul> </li> <li>논문에서는 Obstacle pointcloud가 입력으로 들어간다고 밝히지만, 정확히 어떠한 형식으로 사용되는지는 설명이 조금 부족하다고 느껴집니다.</li> <li>CAE 모델에 대해서 간단하게 MNIST로 코드를 수행해봤었는데, Point cloud data로도 학습이 잘 수행되는지 확인해봐야 할 것 같습니다.</li> </ul> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/6dof-graspnet/">[paper-review] 6-DOF GraspNet: Variational Grasp Generation for Object Manipulation</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/stow/">[paper-review] Predicting Object Interactions with Behavior Primitives: An Application in Stowing Tasks</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/rba/">[paper-review] Relative Behavioral Attributes: Filling the Gap between Symbolic Goal Specification and Reward Learning from Human Preferences</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/dream2real/">[paper-review] Dream2Real: Zero-Shot 3D Object Rearrangement with Vision-Language Models</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/staa/">[paper-review] Fast-Replanning Motion Control for Non-Holonomic Vehicles with Aborting A*</a> </li> <div id="giscus_thread" style="max-width: 800px; margin: 0 auto;"> <script>let giscusTheme=localStorage.getItem("theme"),giscusAttributes={src:"https://giscus.app/client.js","data-repo":"joonhyung-lee/joonhyung-lee.github.io","data-repo-id":"","data-category":"Comments","data-category-id":"","data-mapping":"title","data-strict":"1","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":giscusTheme,"data-lang":"en",crossorigin:"anonymous",async:""},giscusScript=document.createElement("script");Object.entries(giscusAttributes).forEach(([t,e])=>giscusScript.setAttribute(t,e)),document.getElementById("giscus_thread").appendChild(giscusScript);</script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 Joel Lee. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?2930004b8d7fcd0a8e00fdcfc8fc9f24"></script> <script defer src="/assets/js/common.js?4a129fbf39254905f505c7246e641eaf"></script> <script defer src="/assets/js/copy_code.js?7254ae07fe9cc5f3a10843e1c0817c9c" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>