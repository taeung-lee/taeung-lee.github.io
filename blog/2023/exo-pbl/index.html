<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> [paper-review] User preference optimization for control of ankle exoskeletons using sample efficient active learning | Joel Lee </title> <meta name="author" content="Joel Lee"> <meta name="description" content="paper review about exo-pbl"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://joonhyung-lee.github.io//blog/2023/exo-pbl/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?bf50d6d9dd867d3e0f3b0add94449649"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> Joel Lee </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">miscellaneous </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/repositories/">repositories</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/teaching/">teaching</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/gallery/">gallery</a> </div> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">[paper-review] User preference optimization for control of ankle exoskeletons using sample efficient active learning</h1> <p class="post-meta"> October 29, 2023 </p> <p class="post-tags"> <a href="/blog/2023"> <i class="fa-solid fa-calendar fa-sm"></i> 2023 </a>   ·   <a href="/blog/tag/exoskeletons"> <i class="fa-solid fa-hashtag fa-sm"></i> Exoskeletons</a>   <a href="/blog/tag/preference-based-learning"> <i class="fa-solid fa-hashtag fa-sm"></i> Preference-Based Learning</a>   <a href="/blog/tag/science-robotics"> <i class="fa-solid fa-hashtag fa-sm"></i> Science Robotics</a>   <a href="/blog/tag/2023"> <i class="fa-solid fa-hashtag fa-sm"></i> 2023</a>     ·   <a href="/blog/category/paper-review"> <i class="fa-solid fa-tag fa-sm"></i> paper-review</a>   <a href="/blog/category/paper-review-pbl"> <i class="fa-solid fa-tag fa-sm"></i> paper-review/PBL</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <blockquote> <p>Science Robotics 2023. [<a href="https://www.science.org/doi/10.1126/scirobotics.adg3705" rel="external nofollow noopener" target="_blank">Paper</a>] [<a href="https://www.science.org/doi/suppl/10.1126/scirobotics.adg3705/suppl_file/scirobotics.adg3705_sm.pdf" rel="external nofollow noopener" target="_blank">Code</a>]</p> <p>Ung Hee Lee and Varun S. Shetty and Patrick W. Franks and Jie Tan and Georgios Evangelopoulos and Sehoon Ha and Elliott J. Rouse</p> <p>18 Oct 2023</p> </blockquote> <h2 id="한-문장-요약">한 문장 요약</h2> <p>요약: Exoskeleton에서 Preference를 결정짓는 control parameter를(=4개) 자동으로 튜닝해주는 연구를 수행했다.</p> <blockquote> <p>Offline RL method that never needs to evaluate actions outside of the dataset, but still enables the learned policy to improve substantially over the best behavior in the data through generalization</p> <p>Keyword: <strong>Preference-Based Learning</strong>, <strong>Exoskeletons</strong></p> </blockquote> <h3 id="abstract">Abstract</h3> <ul> <li> <strong>기존의 한계</strong> <ul> <li>resource intensive</li> <li>only enabling a single objective optimization <ul> <li>we can do it for many factors, including comfort, fatigue, and stability, among others</li> <li>conveniently tune the four parameters</li> </ul> </li> </ul> </li> <li> <strong>Approach</strong> <ul> <li>used an evolutionary algorithm to recommend potential parameters, which were ranked by a neural network <code class="language-plaintext highlighter-rouge">RankNet</code>. <ul> <li>real-time feedback as a force-choice comparison (=binary comparison)</li> </ul> </li> <li>accuracy of 88% on average when compared with randomly generated parameters.</li> <li>user-preferred settings stabilized in 43 \(\pm\) 7 queries.</li> </ul> </li> </ul> <h3 id="introduction">Introduction</h3> <p>기존의 웨어러블 기기에서 수행된 PBL은 두 가지 방식이 있다.</p> <ol> <li>Expert-based tuning to mimic natural human locomotion ⇒ Learning from Demonstration</li> <li>Automatic tuning based on metabolic rate or other physiological objectives. <ul> <li>위 방법들은 성공적으로 수행되어 왔지만, 오직 하나의 요소에 대해서만 PBL이 수행되어 왔다. (=<code class="language-plaintext highlighter-rouge">single objective</code>)</li> <li>따라서 이러한 한계를 해결하고자 여러 요소를 고려하는 <code class="language-plaintext highlighter-rouge">Multi-objective</code> optimization 방법들도 연구되고 있지만, 아직까진 그렇게 성공적이진 않다고 한다.</li> </ul> </li> </ol> <ul> <li>low-dimensional controller parameter space(=튜닝 파라미터의 총 갯수)로는 실제 환경의 모든 상황으로 확장이 불가하며, 저자는 이를 active learning으로 수행하겠다고 한다. <ul> <li>The algorithm searches a parameter space automatic</li> </ul> </li> </ul> <p>요약하자면, 저자가 주장하는 contribution은 아래의 두 가지 입니다.</p> <ul> <li>sample-efficient optimization algorithm: four-dimensional parameter space</li> <li>real-time framework for allowing users to determine preference at will <ul> <li> <code class="language-plaintext highlighter-rouge">RankCMA-ES</code>라는 이름으로 알고리즘을 제안함.</li> </ul> </li> </ul> <h3 id="contribution">Contribution</h3> <ol> <li>Sample-Efficient <ol> <li>이전 연구에서 Covariance Matrix Adaptation-Evolutionary Strategy (CMA-ES)로 metabolic rate를 최적화 하는 연구가 수행되었으나 PBL로는 확장되지 못하였음.</li> <li>저자는 RankNet을 사용해 CMA-ES 방법론을 합침. (Binary comparison: [A or B]) <ul> <li>이전 PBL 연구에서는 5개의 option에 대해 2개의</li> </ul> </li> </ol> </li> <li>Real-world에서 사용 가능하다 <ol> <li>웨어러블 기기와 사용자의 binary comparison만 있으면 내부 알고리즘이 동작하므로 실생활에 사용할 수 있다는 의미.</li> <li>그리고 사용자가 tuning pace를 조절할 수도 있음.</li> </ol> </li> </ol> <h3 id="approach">Approach</h3> <div align="center"> <img src="/assets/img/exo-pbl/exo-pbl-overview.png" width="100%"> <p>Fig. 1: Overview of the Exoskeleton PBL.</p> </div> <ul> <li>저자는 RankNet을 사용하여 preference를 모델링 했다. (preference score를 continuous하게 추정하기 위해 preference가 neural network에서 활용된 연구임.) <ul> <li><strong>Input: controller setting / output: normalized in a [0~1] score (latent user score)</strong></li> </ul> </li> <li> <strong>Two-Dim. controller parameter</strong>에서 perference model을 <strong>pre-train</strong> 한 후에 <strong>Four-Dim.</strong>에서 <strong>optimization</strong>을 수행한다. (pre-train 과정에선 이전 연구(<a href="https://www.science.org/doi/10.1126/science.aal5054" rel="external nofollow noopener" target="_blank">Human-in-the-loop optimization of exoskeleton assistance during walking</a>)에서 수행된 데이터를 사용한다고 함.) <ul> <li>Controller parameter: <strong>peak torque</strong> and <strong>peak torque timing</strong> </li> </ul> </li> </ul> <div align="center"> <img src="/assets/img/exo-pbl/exo-pbl-algorithm.png" width="80%"> <p>Fig. 2: Pseudo Algorithm of the Exoskeleton PBL.</p> </div> <ul> <li>Optimization part <ul> <li>user-independent preference model: RankNet <ul> <li>pre-train을 위해 이전 연구에서 사용된 데이터셋을 활용함. <ul> <li>12명의 참가자 + 3개의 다른 속도 (1, 1.2, and 1.4 m/s)</li> <li>데이터로부터 mean과 covariance를 얻어내서, 12개의 개별적인 2D gaussian function을 취득함. ⇒ 이를 preference score로 사용함.</li> </ul> </li> </ul> </li> <li>user-dependent preference model (black-box optimizer): CMA-ES <ul> <li>multivariate normal distribution에서 샘플을 추출</li> <li>이전의 것과 비교하여 더 선호하는 것을 선택</li> <li>선택된 것을 기반으로 covariance matrix \(C\), step size \(\sigma\) 를 업데이트 하며 distribution이 바뀜. <ul> <li>저자는 \(1+\lambda\) CMA-ES 방법론을 사용함.</li> <li>이는 suboptimal에 취약하지만, 빠른 수렴성을 보여서 사용한다고 함. <ul> <li>1: parent의 수</li> <li>+: new generation이 children/parent pool에서 선택된다는 의미</li> <li>\(\lambda\): offspring의 수, search space를 결정함, scheduling parameter</li> </ul> </li> </ul> </li> </ul> </li> </ul> </li> </ul> <h3 id="experiments">Experiments</h3> <div align="center"> <img src="/assets/img/exo-pbl/exo-pbl-experimental-setup.png" width="100%"> <p>Fig. 3: Experimental Setup of the Exoskeleton PBL.</p> </div> <ul> <li>실험 세팅 <ul> <li>피실험자는 총 14명이며 참가자 당 5번의 실험을 수행한다.</li> <li>피실험자는 트레드밀에 고정된 속도 1.2 m/s로 걸으며 2개의 option A/B 를 선택할 수 있는 터치 스크린이 있었으며, 자유롭게 A/B option을 체험해볼 수 있었음. 이 중에서 어떠한 것이 더 좋은지 선택하게끔 함. <ul> <li>이러한 과정을 50번 정도 수행함. 이 숫자는 선행 연구에 기반을 두었다고 언급함.</li> <li>이렇게 main(optimization+validation) session은 39 \(\pm\) 18 분 소요되었음.</li> </ul> </li> </ul> </li> </ul> <div align="center"> <img src="/assets/img/exo-pbl/exo-pbl-gait-result.png" width="100%"> <p>Fig. 4: Gait result of the Exoskeleton PBL.</p> </div> <div align="center"> <img src="/assets/img/exo-pbl/exo-pbl-ranknet-result.png" width="100%"> <p>Fig. 5: RankNet result.</p> </div> <ul> <li>RankCMA-ES를 leave-one-subject-out cross validation으로 수행했다고 함. <ul> <li>n개의 데이터에서 1개를 Test Set으로 정하고 나머지 n-1개의 데이터로 모델링을 하는 방법</li> </ul> </li> <li>CMA-ES 를 baseline으로 삼음. <ul> <li>RankCMA-ES가 더 적은 수(=30 회)의 generation으로 GT에 근접한 score로 수렴했고, baseline은 150회의 generation으로 sub-optimal로 수렴했다. ⇒ sample-efficiency</li> </ul> </li> </ul> <h4 id="thought">Thought</h4> <ul> <li>Introduction에서 밝히길 본 연구는 partial-assist system에 대해서 PBL을 수행했다고 하며, 기존의 연구는 complete-assist exoskeleton에서 PBL이 수행되어 왔다고 합니다. (Bayesian-Optimization + Gaussian Process를 활용함.)</li> <li>아마도 이 이유 때문에 Baseline을 pbl이 아닌 CMA 으로만 수행한 것 같습니다. (PBL에 대해서 수행하는 논문이지만 baseline에는 PBL 관련된 것이 없어서 처음에는 조금 의아했었습니다.)</li> <li>해당 논문에서 사용된 factor로는 다음의 4개를 활용했습니다. rise time (r_t), peak torque timing (p_t), fall time (f_t ), and peak torque magnitude.</li> <li>저자도 논문에서 밝히길 더 많은 수의 factor를 정의해 문제를 해결할 수는 있다고 하며, text로 표현된 내용에 기반해서 preference를 추정하는 접근도 해볼 수 있지 않을까 라는 생각을 했습니다.</li> <li>추가로, preference model에 대해서도 RankNet 이외에도 다른 ranking method를 활용해볼 수 있을 것 같습니다.</li> </ul> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/rba/">[paper-review] Relative Behavioral Attributes: Filling the Gap between Symbolic Goal Specification and Reward Learning from Human Preferences</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/cpl/">[paper-review] Contrastive Prefence Learning: Learning from Human Feedback without RL</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/aligndiff/">[paper-review] AlignDiff: Aligning Diverse Human Preferences via Behavior-customisable Diffusion Model</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/dream2real/">[paper-review] Dream2Real: Zero-Shot 3D Object Rearrangement with Vision-Language Models</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/stow/">[paper-review] Predicting Object Interactions with Behavior Primitives: An Application in Stowing Tasks</a> </li> <div id="giscus_thread" style="max-width: 800px; margin: 0 auto;"> <script>let giscusTheme=localStorage.getItem("theme"),giscusAttributes={src:"https://giscus.app/client.js","data-repo":"joonhyung-lee/joonhyung-lee.github.io","data-repo-id":"","data-category":"Comments","data-category-id":"","data-mapping":"title","data-strict":"1","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":giscusTheme,"data-lang":"en",crossorigin:"anonymous",async:""},giscusScript=document.createElement("script");Object.entries(giscusAttributes).forEach(([t,e])=>giscusScript.setAttribute(t,e)),document.getElementById("giscus_thread").appendChild(giscusScript);</script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 Joel Lee. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?2930004b8d7fcd0a8e00fdcfc8fc9f24"></script> <script defer src="/assets/js/common.js?4a129fbf39254905f505c7246e641eaf"></script> <script defer src="/assets/js/copy_code.js?7254ae07fe9cc5f3a10843e1c0817c9c" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>